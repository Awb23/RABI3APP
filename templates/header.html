{% extends "base.html" %}
{% block content %}
{% load static %}

<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<div class="bg-gray-100 text-gray-700 text-sm py-2 hidden md:block">
    <div class="container mx-auto flex justify-between items-center px-4">
        <div>Welcome to our store!</div>
        <div>
            <a href="#" class="hover:text-gray-900 transition-colors duration-200">Help</a>
            <span class="mx-2">|</span>
            <a href="#" class="hover:text-gray-900 transition-colors duration-200">Contact</a>
        </div>
    </div>
</div>

<nav class="bg-white shadow-md sticky top-0 z-50">
    <div class="container mx-auto px-4 lg:px-8 py-4 flex flex-col lg:flex-row items-center justify-between">
        <a class="flex-shrink-0 mb-4 lg:mb-0" href="{% url 'home' %}">
            <img src="{% static 'images/logo.png' %}" alt="Logo" class="h-12 transition duration-300 ease-in-out transform hover:scale-105">
        </a>
        
        <div class="w-full lg:w-2/5 mx-auto flex items-center justify-center relative">
            <form action="{% url 'search' %}" method="GET" class="w-full flex">
                <input class="w-full px-5 py-3 border border-gray-300 rounded-l-full focus:outline-none focus:border-indigo-500 transition-colors text-sm" type="search" name="query" placeholder="I'm shopping for..." aria-label="Search" required>
                <button class="bg-indigo-500 text-white font-semibold py-3 px-6 rounded-r-full hover:bg-indigo-600 focus:outline-none transition-colors" type="submit">
                    <i class="fas fa-search"></i>
                </button>
            </form>
        </div>
        
        <div class="mt-4 lg:mt-0 flex items-center space-x-6">
            {% if user.is_authenticated %}
                <div class="relative group hidden lg:block">
                    <a class="flex items-center text-gray-700 hover:text-indigo-500 transition-colors cursor-pointer" id="profile-dropdown-btn">
                        <i class="fas fa-user-circle text-2xl mr-2"></i>
                        <span class="font-medium text-sm">Profile</span>
                    </a>
                    <div id="profile-dropdown-menu" class="absolute right-0 mt-2 py-2 w-48 bg-white rounded-lg shadow-xl hidden group-hover:block transition duration-300 ease-in-out z-10">
                        <a class="block px-4 py-2 text-gray-800 hover:bg-gray-100" href="{% url 'adress' %}">Profile</a>
                        <a class="block px-4 py-2 text-gray-800 hover:bg-gray-100" href="{% url 'getsave' %}">Wishlist</a>
                        <a class="block px-4 py-2 text-gray-800 hover:bg-gray-100" href="{% url 'reset' %}">Change Password</a>
                        <hr class="my-2 border-gray-200">
                        <a class="block px-4 py-2 text-gray-800 hover:bg-gray-100" href="{% url 'logout' %}">Logout</a>
                    </div>
                </div>
                
                <a href="{% url 'cart' %}" class="relative flex items-center text-gray-700 hover:text-indigo-500 transition-colors">
                    <i class="fas fa-shopping-cart text-2xl"></i>
                    <span class="absolute -top-1 -right-1 inline-flex items-center justify-center h-4 w-4 text-xs font-bold bg-red-500 rounded-full text-white">
                        {{ user.cart.orders.count }}
                    </span>
                    <span class="ml-2 font-medium text-sm hidden lg:block">Cart</span>
                </a>
            {% else %}
                <a class="flex items-center text-gray-700 hover:text-indigo-500 transition-colors" href="{% url 'sign' %}">
                    <i class="fas fa-user-plus text-2xl mr-2"></i>
                    <span class="font-medium text-sm">Sign Up</span>
                </a>
                <a class="flex items-center text-gray-700 hover:text-indigo-500 transition-colors" href="{% url 'login' %}">
                    <i class="fas fa-sign-in-alt text-2xl mr-2"></i>
                    <span class="font-medium text-sm">Login</span>
                </a>
            {% endif %}
            
            <div class="block lg:hidden">
                <button id="mobile-toggle" class="flex items-center text-gray-700 hover:text-indigo-500 transition-colors">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </div>
    </div>
</nav>

<div class="bg-gray-800 hidden lg:block">
    <div class="container mx-auto px-8">
        <div class="flex space-x-6 text-white font-medium text-sm">
            <a href="{% url 'prodlist' %}" class="py-3 px-2 border-b-2 border-transparent hover:border-white transition-colors duration-300">All Products</a>
            <a href="{% url 'category' %}" class="py-3 px-2 border-b-2 border-transparent hover:border-white transition-colors duration-300">Categories</a>
            <a href="{% url 'contact_us' %}" class="py-3 px-2 border-b-2 border-transparent hover:border-white transition-colors duration-300">Contact Us</a>
            <a href="#" class="py-3 px-2 border-b-2 border-transparent hover:border-white transition-colors duration-300">About Us</a>
            {% if user.is_authenticated %}
                <a href="{% url 'logout' %}" class="py-3 px-2 border-b-2 border-transparent hover:border-white transition-colors duration-300" onclick="return confirm('Are you sure you want to log out?');">Logout</a>
            {% endif %}
        </div>
    </div>
</div>

<div id="mobile-menu" class="fixed top-0 left-0 w-full h-full bg-white z-50 transform -translate-x-full transition-transform duration-300 lg:hidden">
    <div class="p-6">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-bold text-gray-800">Menu</h2>
            <button id="close-mobile-menu" class="text-gray-700 hover:text-indigo-500">
                <i class="fas fa-times text-2xl"></i>
            </button>
        </div>
        <ul class="space-y-4">
            <li><a href="{% url 'home' %}" class="block text-lg text-gray-700 hover:text-indigo-500 transition-colors"><i class="fas fa-home mr-2"></i> Home</a></li>
            <li><a href="{% url 'prodlist' %}" class="block text-lg text-gray-700 hover:text-indigo-500 transition-colors">All Products</a></li>
            <li><a href="{% url 'category' %}" class="block text-lg text-gray-700 hover:text-indigo-500 transition-colors">Categories</a></li>
            <li><a href="{% url 'contact_us' %}" class="block text-lg text-gray-700 hover:text-indigo-500 transition-colors">Contact Us</a></li>
            <li><a href="#" class="block text-lg text-gray-700 hover:text-indigo-500 transition-colors">About Us</a></li>
            {% if user.is_authenticated %}
                <li><hr class="my-2"></li>
                <li><a href="{% url 'adress' %}" class="block text-lg text-gray-700 hover:text-indigo-500 transition-colors"><i class="fas fa-user-circle mr-2"></i> Profile</a></li>
                <li><a href="{% url 'getsave' %}" class="block text-lg text-gray-700 hover:text-indigo-500 transition-colors"><i class="fas fa-heart mr-2"></i> Wishlist</a></li>
                <li><a href="{% url 'reset' %}" class="block text-lg text-gray-700 hover:text-indigo-500 transition-colors"><i class="fas fa-key mr-2"></i> Change Password</a></li>
                <li><a href="{% url 'logout' %}" class="block text-lg text-gray-700 hover:text-indigo-500 transition-colors" onclick="return confirm('Are you sure you want to log out?');"><i class="fas fa-sign-out-alt mr-2"></i> Logout</a></li>
            {% else %}
                <li><hr class="my-2"></li>
                <li><a href="{% url 'sign' %}" class="block text-lg text-gray-700 hover:text-indigo-500 transition-colors"><i class="fas fa-user-plus mr-2"></i> Sign Up</a></li>
                <li><a href="{% url 'login' %}" class="block text-lg text-gray-700 hover:text-indigo-500 transition-colors"><i class="fas fa-sign-in-alt mr-2"></i> Login</a></li>
            {% endif %}
        </ul>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const mobileToggle = document.getElementById('mobile-toggle');
        const mobileMenu = document.getElementById('mobile-menu');
        const closeMobileMenu = document.getElementById('close-mobile-menu');
        
        mobileToggle.addEventListener('click', function() {
            mobileMenu.classList.remove('-translate-x-full');
        });

        closeMobileMenu.addEventListener('click', function() {
            mobileMenu.classList.add('-translate-x-full');
        });
        
        const profileDropdownBtn = document.getElementById('profile-dropdown-btn');
        const profileDropdownMenu = document.getElementById('profile-dropdown-menu');

        if (profileDropdownBtn && profileDropdownMenu) {
            profileDropdownBtn.addEventListener('click', function(e) {
                e.preventDefault(); // Prevent default link behavior
                e.stopPropagation();
                profileDropdownMenu.classList.toggle('hidden');
            });
            
            // Close dropdown when clicking outside
            window.addEventListener('click', function(e) {
                if (!profileDropdownBtn.contains(e.target) && !profileDropdownMenu.contains(e.target)) {
                    profileDropdownMenu.classList.add('hidden');
                }
            });
        }
    });
</script>

{% endblock content %}